# rMATS Workflow - COG Analysis 

Subprojects:
1. Risk groups rmats 
2. CBF-AML rmats
3. NPM-AML rmats
4. leukemic burden (WBC) rMATS
5. Other stats
  - Stats for high risk prevelenace in Black subgroup
  - Stats for leukemia burden prevalence in Black subgroup


1. Getting the rMATS output files from Cavatica

```
cd kf_python_api 
conda create --prefix ./cavatica-api-env
conda activate ./cavatica-api-env
conda install -c conda-forge -c bioconda python=3 
pip install git+https://github.com/kids-first/kf-cavatica-python-tools.git 
git clone https://github.com/kids-first/kf-cavatica-python-tools.git

cd kf_python_api #if needed

conda activate ./cavatica-api-env

python ./kf-cavatica-python-tools/recipes/download_files.py --project_name COG_analysis --project_path 2021OCT23_COG_rmats-output --download_location /mnt/isilon/xing_lab/aspera/adamsj/COG-analysis_metadataV2/COG_rmats-output
```

2. ( FOR CAVATICA RUNS ) Subset the data into replicate groups from BAMs 

```python _2_csv_indices_from_bams.py --input-csv _2_aggregated.csv --group1-bams /mnt/isilon/xing_lab/aspera/kutscherae/data_download/20220926_nationsc/Cat/TAR1_PRIM_D5_09_2022/Bam-files/b1_TAR.txt --group2-bams /mnt/isilon/xing_lab/aspera/kutscherae/data_download/20220926_nationsc/Cat/TAR1_PRIM_D5_09_2022/Bam-files/b2_TAR.txt
```
    - This is originally located in ```/mnt/isilon/xing_lab/aspera/adamsj/kfAML_BAMs/_2_csv_indices_from_bams.py```
    - The output should print to the terminal -- copy and paste the indices for step 3

3. ( FOR CAVATICA RUNS ) Stats part 1: prepare the stats input to modify the subset and create a new output directory ```python _3_prepare_stats_input.py --new-output-dir /mnt/isilon/xing_lab/aspera/adamsj/post_output_kfAML/high-low --old-output-dir /mnt/isilon/xing_lab/aspera/adamsj/post_output_kfAML/ --group-1-indices 2,10,23,29,37,42,73,88,89,93,10 ... --group-2-indices 4,6,7,9,11,12,14,15,16,21,24,27,32,34,...```


